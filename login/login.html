<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collect your GamingTools</title>
    <link rel="stylesheet" href="login.css">
    <link rel="shortcut icon" href="logo.png" type="image/x-icon">
</head>
<body>
    <div class="navbar">
        <a href="/"> <img src="../images/logo.png" class="logo" alt="Logo"></a>
        <a href="/"><span class="website-name">Collect your GamingTools</span></a>
        <nav>
            <ul id="menuList">
                <li><a href="#">Game Controllers</a></li>
                <li><a href="#">VR Accessories</a></li>
                <li><a href="#">Media Remotes</a></li>
                <li><a href="#">Others</a></li>
                <li class="login"><a href="login/login.html">Login</a></li>
            </ul>
        </nav>
    </div>
    
        <img src="images/menu.png" class="menu-icon" onclick="toggleMenu()">
    <div class="linksHome">
        <a href="../index.html">home</a>
    </div>
    <div class="login-container">
        
        <h1>Login to Your Account</h1>
        <form action="index.html" method="post">
            <div class="input-group">
                <label for="username">Gmail</label>
                <input type="text" id="gmail" name="username" required>
            </div>
            <div class="input-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div ontouchstart="">
  <div class="button">
    <a href="#">Login</a>
  </div>
</div>
        </form>
        <div class="links">
            <a href="forgot.html" class="hal">Forgot Password?</a>
            <a href="../SignUp/signup.html" class="hal2">Sign Up</a>
        </div>
    </div>
</body>

<script>
    const login = document.querySelector(".button");

    login.addEventListener("click",(e)=>{
        e.preventDefault();

        const email = document.querySelector("#gmail").value;
        const password = document.querySelector("#password").value;
        const userData = {
            email,
            password
        }
        console.log(userData)
        loginUser(userData)
    })

    const loginUser = async (user)=>{
    try{
        const res = await fetch("http://localhost:5000/auth/signin",{
            method:"POST",
            credentials:"include",
            redirect:"follow",
            headers:{"content-type":"application/json"},
            body:JSON.stringify(user)
        })
        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }
        const data = await res.json();
  

        window.location.href="http://127.0.0.1:5500/Collect-your-GamingTools/index.html"
    }catch(e){
        console.log(e.message);
    }
    }
</script>
</html>
